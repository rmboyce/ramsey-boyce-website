<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Image Rating Neural Network</title>
    <meta name="description" content="Ramsey Boyce's Website">
    <link rel="canonical" href="https://ramseyboyce.com/smaller_projects/image_rater.html">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" type="image/png" href="../resources/favicon_16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="../resources/favicon_32x32.png" sizes="32x32">
</head>
<body>
<div id="container">
    <header>
        <p class="navBar">
            <a href="../bigger_projects.html" title="Large, useful projects">Bigger Projects</a>
            &middot;
            <a href="../smaller_projects.html" title="Small, one-off projects for fun">Smaller Projects</a>
            &middot;
            <a href="../javascript_demos.html" title="My Javascript programs (they run in the browser)">Javascript Demos</a>
            &middot;
            <a href="../index.html" title="About me">About</a>
        </p>
    </header>

    <article>
        <h1>Image Rating Neural Network</h1>
        
        <p class="smallDesc">An image rater based on the average person's judgement</p>
        
        <h2>Overview</h2>
        <p>This is a Python program I made that builds and trains a neural network which assigns aesthetic quality scores to images. The scores are based on what the average person would say. It is trained on images from the <a href="http://refbase.cvc.uab.es/files/MMP2012a.pdf" title="AVA dataset" rel="nofollow">AVA (Aesthetic Visual Analysis)</a> dataset, available <a href="https://academictorrents.com/details/71631f83b11d3d79d8f84efe0a7e12f0ac001460" title="Academictorrents AVA dataset" rel="nofollow">here</a>.</p>
        <p>Uses Jupyter Notebook. Download pdf version of notebook <a href="../resources/Image_Rater_Transfer_Learning.pdf" title="Jupyter Notebook pdf">here</a>.</p>
        
        <p>
            <img alt="Network diagram" src="../resources/network_visualization_two_hidden_layers.jpg" width="580" height="502">
        </p>
        
        <h2>Usage</h2>
        <p>Download pdf version of Jupyter notebook file <a href="../resources/Image_Rater_Transfer_Learning.pdf" title="Jupyter Notebook pdf">here</a>.</p>
        <p>Get the code (an ipynb file): <a href="https://github.com/rmboyce/image_rater" title="Image rater code" rel="nofollow">https://github.com/rmboyce/image_rater</a></p>
        <p>The ipynb is a file you can run on your computer using Jupyter Notebook. If you run the notebook, you will need the AVA dataset on your local computer. Note the hardcoded location ("E:/AVA_dataset") in the python code.</p>
        
        <p>
            <img alt="Transfer learning diagram" src="../resources/transfer_learning.jpg" width="647" height="381">
        </p>
        
        <h2>Technical Details</h2>
        <p>The image rater first uses the <a href="https://github.com/machrisaa/tensorflow-vgg" title="VGG Github" rel="nofollow">VGG19</a> network to convert images from the AVA dataset into codes, then runs the codes through a fully-connected network with two hidden layers to return image ratings (see figure 1 above). The rating for an image is in the form of a probability distribution over the integers from 1 (lowest quality) to 10 (highest quality).</p>
        <p>The network achieves a correlation coefficient of 0.52 between the predicted and actual ratings for a validation set of images. Additionally, I do a factor analysis to determine which VGG19 codes have the largest effect on image quality. The notebook includes functions to show a selection of images with high values of any VGG19 code.</p>
    </article>
    
    <footer>
        <p class="smallDesc">By Ramsey Boyce; Copyright &#169; 2020</p>
    </footer>
</div>
</body>
</html>